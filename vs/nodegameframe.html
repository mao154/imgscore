<script>
function receiveMessage(event) {
  var id;
  var tokens, name, value;
  id = event.data;

  // Back compatibility naming.
  if (id === "closeQSIWindow" || id === "quit") {
    quit();
  }
  // Back compatibility naming.
  else if (id === "popupConsent" || id === "requestConsent") {
    if (REQUEST_CONSENT) requestConsent();
    else console.log("consent form not shown. check the game settings.");
  }
  else if (id === "experimentComplete") {
    experimentComplete();
  }
  else if (id.indexOf("readUserHT") === 0) {
    tokens = id.split("^__^");
    name = tokens[1];
    value = tokens[2];
    readUserHT(function(data) {
      if (data.value === null) writeUserHT(name, value);
    }, name)
  }
  else {
    console.log('Received unknown post message:', id);
  }
}

function initialize() {
  var link, extraVars;

  // Add post messages listener.
  window.addEventListener("message", receiveMessage, false);

  // Default link.
  link = 'https://nodesim.org';

  // Extra variables.
  if ('undefined' !== typeof seed && 'undefined' !== typeof myid) {
    extraVars = '?vsgid=' + seed + '&vspid=' + myid;
  }
  // Autoplay (if permitted by server).
  extraVars += '&clientType=autoplay';

  // Create full link.
  link += extraVars;

  // Connect iframe.
  document.getElementById("nodegameframe").src = link;
}
</script>
<iframe id="nodegameframe" style="width:100%; height:800px"></iframe>
